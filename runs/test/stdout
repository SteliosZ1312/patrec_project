C:\Users\user\miniconda3\envs\Uomh\lib\site-packages\torch\autograd\profiler.py:255: UserWarning: CUDA is not available, disabling CUDA profiling
  warn("CUDA is not available, disabling CUDA profiling")
----------cfg----------
{   'flatten': True,
    'denoising_sigma': None,
    'dequantize': False,
    'scale_data': True,
    'whitening_transform': False,
    'optimizer': 'adam',
    'lr': 0.001,
    'use_lr_scheduler': False,
    'max_epochs': 100,
    'max_grad_norm': 10,
    'conditioning': None,
    'conditioning_dimension': 0,
    'early_stopping_metric': None,
    'max_bad_valid_epochs': None,
    'make_valid_loader': True,
    'valid_fraction': 0.1,
    'lr_scheduler': 'cosine',
    'lr_scheduler_step': 100,
    'lr_scheduler_gamma': 0.1,
    'valid_metrics': ['l2_reconstruction_error'],
    'test_metrics': ['l2_reconstruction_error', 'fid'],
    'device': 'cpu',
    'train_batch_size': 128,
    'valid_batch_size': 128,
    'test_batch_size': 128,
    'data_root': 'data/',
    'logdir_root': 'runs/',
    'class_ind': -1,
    'transforms': None,
    'dataset': 'mnist',
    'model': 'vae',
    'gae': True,
    'latent_dim': 20,
    'single_sigma': True,
    'decoder_variance_lower_bound': 0,
    'base_distribution': 'gaussian',
    'num_prior_components': 10,
    'distribution_mean_spacing': 1,
    'encoder_net': 'mlp',
    'encoder_hidden_dims': [256],
    'decoder_net': 'mlp',
    'decoder_hidden_dims': [256],
    'train_dataset_size': 54000,
    'data_shape': (1, 28, 28),
    'data_dim': 784}
Did not find latest checkpoint
Did not find best_valid checkpoint
Training[0/421]   0%|                                                                                                                                                                  [00:00<?]Training[2/421]   0%|▋                                                                                                                                                             [00:00<00:31]Training[5/421]   1%|█▊                                                                                                                                                            [00:00<00:22]Training[8/421]   2%|██▉                                                                                                                                                           [00:00<00:20]Training[11/421]   3%|████                                                                                                                                                         [00:00<00:22]Training[13/421]   3%|████▊                                                                                                                                                        [00:00<00:21]Training[15/421]   4%|█████▌                                                                                                                                                       [00:00<00:21]Training[18/421]   4%|██████▋                                                                                                                                                      [00:00<00:20]Training[21/421]   5%|███████▊                                                                                                                                                     [00:01<00:19]Training[24/421]   6%|████████▉                                                                                                                                                    [00:01<00:19]Training[27/421]   6%|██████████                                                                                                                                                   [00:01<00:19]Training[30/421]   7%|███████████                                                                                                                                                  [00:01<00:18]Training[33/421]   8%|████████████▏                                                                                                                                                [00:01<00:18]Training[36/421]   9%|█████████████▎                                                                                                                                               [00:01<00:17]Training[39/421]   9%|██████████████▍                                                                                                                                              [00:01<00:17]Training[42/421]  10%|███████████████▌                                                                                                                                             [00:02<00:17]Training[45/421]  11%|████████████████▋                                                                                                                                            [00:02<00:17]Training[48/421]  11%|█████████████████▊                                                                                                                                           [00:02<00:16]Training[51/421]  12%|██████████████████▉                                                                                                                                          [00:02<00:16]Training[54/421]  13%|████████████████████                                                                                                                                         [00:02<00:16]Training[57/421]  14%|█████████████████████                                                                                                                                        [00:02<00:16]Training[60/421]  14%|██████████████████████▏                                                                                                                                      [00:02<00:16]Training[63/421]  15%|███████████████████████▎                                                                                                                                     [00:03<00:16]Training[66/421]  16%|████████████████████████▍                                                                                                                                    [00:03<00:16]Training[69/421]  16%|█████████████████████████▌                                                                                                                                   [00:03<00:15]Training[72/421]  17%|██████████████████████████▋                                                                                                                                  [00:03<00:15]Training[75/421]  18%|███████████████████████████▊                                                                                                                                 [00:03<00:15]Training[78/421]  19%|████████████████████████████▉                                                                                                                                [00:03<00:15]Training[81/421]  19%|██████████████████████████████                                                                                                                               [00:03<00:14]Training[84/421]  20%|███████████████████████████████▏                                                                                                                             [00:03<00:14]Training[87/421]  21%|████████████████████████████████▏                                                                                                                            [00:04<00:14]Training[90/421]  21%|█████████████████████████████████▎                                                                                                                           [00:04<00:14]Training[93/421]  22%|██████████████████████████████████▍                                                                                                                          [00:04<00:14]Training[96/421]  23%|███████████████████████████████████▌                                                                                                                         [00:04<00:14]Training[99/421]  24%|████████████████████████████████████▋                                                                                                                        [00:04<00:16]Training[102/421]  24%|█████████████████████████████████████▌                                                                                                                      [00:04<00:15]Training[105/421]  25%|██████████████████████████████████████▋                                                                                                                     [00:04<00:15]Training[108/421]  26%|███████████████████████████████████████▊                                                                                                                    [00:05<00:14]Training[111/421]  26%|████████████████████████████████████████▊                                                                                                                   [00:05<00:14]Training[114/421]  27%|█████████████████████████████████████████▉                                                                                                                  [00:05<00:14]Training[117/421]  28%|███████████████████████████████████████████                                                                                                                 [00:05<00:14]Training[120/421]  29%|████████████████████████████████████████████▏                                                                                                               [00:05<00:13]Training[123/421]  29%|█████████████████████████████████████████████▎                                                                                                              [00:05<00:13]Training[126/421]  30%|██████████████████████████████████████████████▍                                                                                                             [00:05<00:13]Training[129/421]  31%|███████████████████████████████████████████████▍                                                                                                            [00:06<00:13]Training[132/421]  31%|████████████████████████████████████████████████▌                                                                                                           [00:06<00:13]Training[135/421]  32%|█████████████████████████████████████████████████▋                                                                                                          [00:06<00:12]Training[138/421]  33%|██████████████████████████████████████████████████▊                                                                                                         [00:06<00:12]Training[141/421]  33%|███████████████████████████████████████████████████▉                                                                                                        [00:06<00:12]Training[144/421]  34%|█████████████████████████████████████████████████████                                                                                                       [00:06<00:12]Training[147/421]  35%|██████████████████████████████████████████████████████                                                                                                      [00:06<00:12]Training[150/421]  36%|███████████████████████████████████████████████████████▏                                                                                                    [00:06<00:12]Training[153/421]  36%|████████████████████████████████████████████████████████▎                                                                                                   [00:07<00:11]Training[156/421]  37%|█████████████████████████████████████████████████████████▍                                                                                                  [00:07<00:11]Training[159/421]  38%|██████████████████████████████████████████████████████████▌                                                                                                 [00:07<00:11]Training[162/421]  38%|███████████████████████████████████████████████████████████▋                                                                                                [00:07<00:11]Training[165/421]  39%|████████████████████████████████████████████████████████████▋                                                                                               [00:07<00:11]Training[168/421]  40%|█████████████████████████████████████████████████████████████▊                                                                                              [00:07<00:10]Training[171/421]  41%|██████████████████████████████████████████████████████████████▉                                                                                             [00:07<00:10]Training[174/421]  41%|████████████████████████████████████████████████████████████████                                                                                            [00:08<00:10]Training[177/421]  42%|█████████████████████████████████████████████████████████████████▏                                                                                          [00:08<00:10]Training[180/421]  43%|██████████████████████████████████████████████████████████████████▎                                                                                         [00:08<00:10]Training[183/421]  43%|███████████████████████████████████████████████████████████████████▍                                                                                        [00:08<00:10]Training[186/421]  44%|████████████████████████████████████████████████████████████████████▍                                                                                       [00:08<00:10]Training[189/421]  45%|█████████████████████████████████████████████████████████████████████▌                                                                                      [00:08<00:09]Training[192/421]  46%|██████████████████████████████████████████████████████████████████████▋                                                                                     [00:08<00:09]Training[195/421]  46%|███████████████████████████████████████████████████████████████████████▊                                                                                    [00:08<00:10]Training[198/421]  47%|████████████████████████████████████████████████████████████████████████▉                                                                                   [00:09<00:10]Training[201/421]  48%|██████████████████████████████████████████████████████████████████████████                                                                                  [00:09<00:09]Training[204/421]  48%|███████████████████████████████████████████████████████████████████████████                                                                                 [00:09<00:09]Training[207/421]  49%|████████████████████████████████████████████████████████████████████████████▏                                                                               [00:09<00:09]Training[210/421]  50%|█████████████████████████████████████████████████████████████████████████████▎                                                                              [00:09<00:09]Training[213/421]  51%|██████████████████████████████████████████████████████████████████████████████▍                                                                             [00:09<00:09]Training[216/421]  51%|███████████████████████████████████████████████████████████████████████████████▌                                                                            [00:09<00:08]Training[219/421]  52%|████████████████████████████████████████████████████████████████████████████████▋                                                                           [00:10<00:09]Training[222/421]  53%|█████████████████████████████████████████████████████████████████████████████████▋                                                                          [00:10<00:08]Training[225/421]  53%|██████████████████████████████████████████████████████████████████████████████████▊                                                                         [00:10<00:08]Training[228/421]  54%|███████████████████████████████████████████████████████████████████████████████████▉                                                                        [00:10<00:08]Training[231/421]  55%|█████████████████████████████████████████████████████████████████████████████████████                                                                       [00:10<00:08]Training[234/421]  56%|██████████████████████████████████████████████████████████████████████████████████████▏                                                                     [00:10<00:08]Training[237/421]  56%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                    [00:10<00:08]Training[240/421]  57%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                   [00:10<00:07]Training[243/421]  58%|█████████████████████████████████████████████████████████████████████████████████████████▍                                                                  [00:11<00:07]Training[246/421]  58%|██████████████████████████████████████████████████████████████████████████████████████████▌                                                                 [00:11<00:07]Training[249/421]  59%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                [00:11<00:07]Training[252/421]  60%|████████████████████████████████████████████████████████████████████████████████████████████▊                                                               [00:11<00:07]Training[255/421]  61%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                                              [00:11<00:07]Training[258/421]  61%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                             [00:11<00:07]Training[261/421]  62%|████████████████████████████████████████████████████████████████████████████████████████████████                                                            [00:11<00:06]Training[264/421]  63%|█████████████████████████████████████████████████████████████████████████████████████████████████▏                                                          [00:11<00:06]Training[267/421]  63%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                                                         [00:12<00:06]Training[270/421]  64%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                        [00:12<00:06]Training[273/421]  65%|████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       [00:12<00:06]Training[276/421]  66%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                      [00:12<00:06]Training[279/421]  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                     [00:12<00:06]Training[282/421]  67%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                    [00:12<00:06]Training[285/421]  68%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   [00:12<00:05]Training[288/421]  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████                                                  [00:13<00:05]Training[291/421]  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                [00:13<00:05]Training[294/421]  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                               [00:13<00:05]Training[297/421]  71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                              [00:13<00:05]Training[300/421]  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                             [00:13<00:05]Training[303/421]  72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            [00:13<00:05]Training[306/421]  73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           [00:13<00:05]Training[309/421]  73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                          [00:14<00:05]Training[312/421]  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                         [00:14<00:05]Training[315/421]  75%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        [00:14<00:04]Training[318/421]  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                       [00:14<00:04]Training[321/421]  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                     [00:14<00:04]Training[324/421]  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                    [00:14<00:04]Training[327/421]  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   [00:14<00:04]Training[330/421]  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                  [00:14<00:04]Training[333/421]  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 [00:15<00:03]Training[336/421]  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                [00:15<00:03]Training[339/421]  81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                               [00:15<00:03]Training[342/421]  81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                              [00:15<00:03]Training[345/421]  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                             [00:15<00:03]Training[348/421]  83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            [00:15<00:03]Training[351/421]  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          [00:15<00:03]Training[354/421]  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                         [00:16<00:03]Training[357/421]  85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                        [00:16<00:02]Training[360/421]  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       [00:16<00:02]Training[363/421]  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                      [00:16<00:02]Training[366/421]  87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                     [00:16<00:02]Training[369/421]  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    [00:16<00:02]Training[371/421]  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   [00:16<00:03]Training[373/421]  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  [00:17<00:03]Training[375/421]  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                  [00:17<00:02]Training[377/421]  90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 [00:17<00:02]Training[380/421]  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                [00:17<00:02]Training[383/421]  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████               [00:17<00:02]Training[386/421]  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              [00:17<00:01]Training[388/421]  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             [00:17<00:01]Training[390/421]  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            [00:18<00:01]Training[392/421]  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           [00:18<00:01]Training[395/421]  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍          [00:18<00:01]Training[398/421]  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         [00:18<00:01]Training[401/421]  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        [00:18<00:01]Training[403/421]  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       [00:18<00:00]Training[406/421]  96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      [00:18<00:00]Training[409/421]  97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     [00:18<00:00]Training[412/421]  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋    [00:19<00:00]Training[415/421]  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   [00:19<00:00]Training[418/421]  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  [00:19<00:00]Training[421/421] 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ [00:19<00:00]Training[421/421] 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████ [00:19<00:00]
E:\OneDrive\projects\HMMY\Χ23\PatRec\project\patrec_project\two_step_zoo\trainers\single_trainer.py:246: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
vae loss: 747.9200 after 1 epochs
Traceback (most recent call last):
  File "E:\OneDrive\projects\HMMY\Χ23\PatRec\project\patrec_project\single_main.py", line 174, in <module>
    trainer.train()
  File "E:\OneDrive\projects\HMMY\Χ23\PatRec\project\patrec_project\two_step_zoo\trainers\single_trainer.py", line 123, in train
    self.prof.stop()
  File "C:\Users\user\miniconda3\envs\Uomh\lib\site-packages\torch\profiler\profiler.py", line 623, in stop
    self._transit_action(self.current_action, None)
  File "C:\Users\user\miniconda3\envs\Uomh\lib\site-packages\torch\profiler\profiler.py", line 651, in _transit_action
    action()
  File "C:\Users\user\miniconda3\envs\Uomh\lib\site-packages\torch\profiler\profiler.py", line 160, in stop_trace
    self.profiler.__exit__(None, None, None)
  File "C:\Users\user\miniconda3\envs\Uomh\lib\site-packages\torch\autograd\profiler.py", line 325, in __exit__
    parsed_results = self._parse_kineto_results(self.kineto_results)
  File "C:\Users\user\miniconda3\envs\Uomh\lib\site-packages\torch\autograd\profiler.py", line 489, in _parse_kineto_results
    scope=kineto_event.scope(),
KeyboardInterrupt
